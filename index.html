<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Music Chamber</title>
  <!-- JoJo-styled font -->
  <link href="https://fonts.googleapis.com/css2?family=Monoton&display=swap" rel="stylesheet">
  <!-- Manifest for PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0B0610">
  <style>
    /* Minimalist JoJo theme */
    body {margin:0; font-family: Arial,sans-serif; background: linear-gradient(135deg,#0B0610,#3D0066); color:#fff;}
    header {display:flex; justify-content:center; align-items:center; height:80px; font-family:'Monoton',cursive; font-size:2em; background-color: rgba(0,0,0,0.5);}
    .search-container {display:flex; justify-content:center; margin:20px;}
    input[type="text"] {width:60%; padding:10px; border-radius:20px; border:none; outline:none; font-size:1em;}
    button {margin-left:10px; padding:10px 15px; border-radius:50%; border:none; background-color:#ffcc00; color:#0B0610; cursor:pointer; font-weight:bold;}
    .song-list {display:flex; flex-direction:column; align-items:center;}
    .song {width:60%; background-color: rgba(255,255,255,0.1); margin:5px; padding:10px; border-radius:10px; display:flex; justify-content:space-between; align-items:center; cursor:pointer; transition:0.2s;}
    .song:hover {background-color: rgba(255,255,255,0.3);}
    .player {position:fixed; bottom:0; width:100%; background: rgba(0,0,0,0.7); display:flex; justify-content:space-around; align-items:center; padding:10px 0;}
    .player button {background-color:transparent; color:#fff; font-size:1.2em;}
    .stats {margin:20px; text-align:center;}
  </style>
</head>
<body>
  <header>Music Chamber</header>

  <div class="search-container">
    <input type="text" id="searchInput" placeholder="Search for a song...">
    <button onclick="searchSong()">ğŸ”</button>
  </div>

  <div class="song-list" id="songList"></div>

  <div class="player">
    <button onclick="prevSong()">â®ï¸</button>
    <button onclick="playPause()">â¯ï¸</button>
    <button onclick="nextSong()">â­ï¸</button>
    <button onclick="toggleShuffle()">ğŸ”€</button>
    <button onclick="toggleLoop()">ğŸ”</button>
    <button onclick="toggleLoopOne()">ğŸ”‚</button>
    <button onclick="toggleAIShuffle()">ğŸ¤–</button>
  </div>

  <div class="stats" id="stats"></div>

  <script>
    // === YOUTUBE API KEY ===
    const YT_API_KEY = 'AIzaSyCGIFGRXBMj9tfht-KksOlD04OWIgX0qHk';

    let currentSongIndex = 0;
    let songs = [];
    let isPlaying = false;
    let shuffle = false;
    let loop = false;
    let loopOne = false;
    let aiShuffle = false;
    let audio = new Audio();

    async function searchSong() {
      const query = document.getElementById('searchInput').value;
      if(!query) return;
      const res = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&maxResults=10&q=${encodeURIComponent(query)}&key=${YT_API_KEY}`);
      const data = await res.json();
      songs = data.items.map(item => ({
        title: item.snippet.title,
        videoId: item.id.videoId
      }));
      displaySongs();
    }

    function displaySongs() {
      const songList = document.getElementById('songList');
      songList.innerHTML = '';
      songs.forEach((song,index)=>{
        const div = document.createElement('div');
        div.className = 'song';
        div.innerHTML = `<span>${song.title}</span> <button onclick="playSong(${index})">â–¶ï¸</button>`;
        songList.appendChild(div);
      });
    }

    function playSong(index){
      currentSongIndex=index;
      audio.src=`https://www.youtube.com/embed/${songs[index].videoId}?autoplay=1`;
      audio.play();
      isPlaying=true;
    }

    function playPause(){ if(isPlaying){audio.pause();} else {audio.play();} isPlaying=!isPlaying; }
    function nextSong(){ if(shuffle){currentSongIndex=Math.floor(Math.random()*songs.length);} else {currentSongIndex++; if(currentSongIndex>=songs.length) currentSongIndex=0;} playSong(currentSongIndex); }
    function prevSong(){ currentSongIndex--; if(currentSongIndex<0) currentSongIndex=songs.length-1; playSong(currentSongIndex); }
    function toggleShuffle(){ shuffle=!shuffle; alert('Shuffle: '+shuffle);}
    function toggleLoop(){ loop=!loop; alert('Loop Playlist: '+loop);}
    function toggleLoopOne(){ loopOne=!loopOne; alert('Loop One Song: '+loopOne);}
    function toggleAIShuffle(){ aiShuffle=!aiShuffle; alert('AI Shuffle: '+aiShuffle);}

    if('serviceWorker' in navigator){
      navigator.serviceWorker.register('/sw.js').then(()=>console.log('Service Worker Registered'));
    }
  </script>
</body>
</html>
